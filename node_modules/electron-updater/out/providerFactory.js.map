{"version":3,"file":"providerFactory.js","sourceRoot":"","sources":["../src/providerFactory.ts"],"names":[],"mappings":";;;;;;;;;AAAA,AAAO,AAA0E,AAAwB,AAAiB,AAAQ,AAAwB,AAAM,AAAsB;;;;;;AAEtL,AAAO,AAAE,AAAe,AAAE,AAAM,AAAmB;;;;;;AACnD,AAAO,AAAE,AAAe,AAAE,AAAM,AAAmB;;;;;;AACnD,AAAO,AAAE,AAAc,AAAE,AAAM,AAAkB;;;;;;AACjD,AAAO,AAAE,AAAqB,AAAE,AAAM,AAAyB,AAE/D,AAAM;;;;sBAAuB,AAA8C,MAAE,AAAmB;AAC9F,AAAqC;AACrC,AAAE,AAAC,QAAC,OAAO,AAAI,SAAK,AAAQ,AAAC,UAAC,AAAC;AAC7B,cAAM,AAAQ,kEAAC,AAAyC,2CAAE,AAA4C,AAAC,AACzG;AAAC;AAED,UAAM,AAAY,eAAG,AAAO,QAAC,AAAY;AACzC,UAAM,AAAQ,WAAG,AAAI,KAAC,AAAQ;AAC9B,AAAM,AAAC,YAAC,AAAQ,AAAC,AAAC,AAAC;AACjB,aAAK,AAAQ;AACX,kBAAM,AAAa,gBAAG,AAAqB;AAC3C,kBAAM,AAAK,QAAG,CAAC,AAAa,cAAC,AAAO,AAAC,AAAC,UAAC,AAAO,QAAC,AAAG,IAAC,AAAQ,YAAI,AAAO,QAAC,AAAG,IAAC,AAAY,AAAC,AAAC,eAAC,AAAI,AAAC,SAAI,AAAa,cAAC,AAAK;AACtH,AAAE,AAAC,gBAAC,AAAK,SAAI,AAAI,AAAC,MAAC,AAAC;AAClB,AAAM,uBAAC,AAAI,AAAc,+DAAC,AAAa,eAAE,AAAO,SAAE,AAAY,AAAC,AACjE;AAAC,AACD,AAAI,mBAAC,AAAC;AACJ,AAAM,uBAAC,AAAI,AAAqB,oFAAC,AAAa,eAAE,AAAK,OAAE,AAAY,AAAC,AACtE;AAAC;AAEH,aAAK,AAAI,AAAC;AACV,aAAK,AAAQ;AACX,AAAM;AACJ,AAAQ,0BAAE,AAAS;AACnB,AAAG,qBAAE,AAAwB,kFAAC,AAAI,AAAC;AACnC,AAAO,yBAAG,AAAsB,KAAC,AAAO,WAAI,AAAI,AACjD;AAJ0B,aAApB,AAAI,AAAe,EAIvB,AAAO,SAAE,AAAQ,aAAK,AAAQ,SAAC,AAAuE,AAAC;AAE5G,aAAK,AAAS;AACZ,kBAAM,AAAO,UAAG,AAA4B;AAC5C,AAAM,mBAAC,AAAI,AAAe,kEAAC,AAAO,SAAE,AAAO,SAAE,AAAO,QAAC,AAAuB,4BAAK,AAAK,SAAI,CAAC,AAAO,QAAC,AAAG,IAAC,AAAQ,SAAC,AAAkB,AAAC,AAAC;AAEtI,aAAK,AAAS;AACZ,AAAM,mBAAC,AAAI,AAAe,kEAAC,AAAsB,MAAE,AAAY,AAAC;AAElE;AACE,kBAAM,AAAQ,AAAC,2FAAyB,AAAQ,QAAE,IAAE,AAAkC,AAAC,AAC3F,AAAC,AACH;;AAAC","sourcesContent":["import { AllPublishOptions, BaseS3Options, BintrayOptions, GenericServerOptions, getS3LikeProviderBaseUrl, GithubOptions, newError, PublishConfiguration } from \"builder-util-runtime\"\nimport { AppUpdater } from \"./AppUpdater\"\nimport { BintrayProvider } from \"./BintrayProvider\"\nimport { GenericProvider } from \"./GenericProvider\"\nimport { GitHubProvider } from \"./GitHubProvider\"\nimport { PrivateGitHubProvider } from \"./PrivateGitHubProvider\"\n\nexport function createClient(data: PublishConfiguration | AllPublishOptions, updater: AppUpdater) {\n  // noinspection SuspiciousTypeOfGuard\n  if (typeof data === \"string\") {\n    throw newError(\"Please pass PublishConfiguration object\", \"ERR_UPDATER_INVALID_PROVIDER_CONFIGURATION\")\n  }\n\n  const httpExecutor = updater.httpExecutor\n  const provider = data.provider\n  switch (provider) {\n    case \"github\":\n      const githubOptions = data as GithubOptions\n      const token = (githubOptions.private ? process.env.GH_TOKEN || process.env.GITHUB_TOKEN : null) || githubOptions.token\n      if (token == null) {\n        return new GitHubProvider(githubOptions, updater, httpExecutor)\n      }\n      else {\n        return new PrivateGitHubProvider(githubOptions, token, httpExecutor)\n      }\n\n    case \"s3\":\n    case \"spaces\":\n      return new GenericProvider({\n        provider: \"generic\",\n        url: getS3LikeProviderBaseUrl(data),\n        channel: (data as BaseS3Options).channel || null\n      }, updater, provider === \"spaces\" /* https://github.com/minio/minio/issues/5285#issuecomment-350428955 */)\n\n    case \"generic\":\n      const options = data as GenericServerOptions\n      return new GenericProvider(options, updater, options.useMultipleRangeRequest !== false && !options.url.includes(\"s3.amazonaws.com\"))\n\n    case \"bintray\":\n      return new BintrayProvider(data as BintrayOptions, httpExecutor)\n\n    default:\n      throw newError(`Unsupported provider: ${provider}`, \"ERR_UPDATER_UNSUPPORTED_PROVIDER\")\n  }\n}"]}
